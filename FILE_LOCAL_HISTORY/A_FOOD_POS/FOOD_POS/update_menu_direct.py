#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Update Menu Script - Direct Database Access
‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏ô‡∏π‡πÇ‡∏î‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
"""

import sys
import os
from pathlib import Path

# Add the project root to Python path
project_root = Path(__file__).parent
sys.path.insert(0, str(project_root))

try:
    from backend.database import DatabaseManager
except ImportError as e:
    print(f"Error importing DatabaseManager: {e}")
    sys.exit(1)

def clear_existing_menu():
    """‡∏•‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"""
    db = DatabaseManager()
    conn = db.get_connection()
    cursor = conn.cursor()
    
    try:
        # ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        cursor.execute("DELETE FROM menu_items")
        print("‚úÖ ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß")
        
        # ‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        cursor.execute("DELETE FROM menu_categories")
        print("‚úÖ ‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß")

        # ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï autoincrement
        cursor.execute("DELETE FROM sqlite_sequence WHERE name='menu_categories'")
        print("‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï ID ‡∏Ç‡∏≠‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß")
        
        conn.commit()

        # ‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        print("üßπ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...")
        conn.execute("VACUUM")
        print("‚úÖ ‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô")

        return True
    except Exception as e:
        conn.rollback()
        print(f"‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏•‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏î‡∏¥‡∏°: {e}")
        return False
    finally:
        conn.close()

def add_categories():
    """‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà"""
    db = DatabaseManager()
    conn = db.get_connection()
    cursor = conn.cursor()
    
    categories = [
        ("‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô", "üç∞", True),
        ("‡∏¢‡∏≥/‡∏™‡∏•‡∏±‡∏î", "ü•ó", True),
        ("‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß", "ü•ò", True),
        ("‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≤‡∏ô‡πÄ‡∏•‡πà‡∏ô", "üç¢", True),
        ("‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°", "üçπ", True)
    ]
    
    for name, icon, is_active in categories:
        cursor.execute(
            "INSERT INTO menu_categories (name, description, is_active) VALUES (?, ?, ?)",
            (name, icon, is_active)
        )
    
    print("‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà 5 ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß")
    conn.commit()
    conn.close()

def add_menu_items():
    """‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà"""
    db = DatabaseManager()
    conn = db.get_connection()
    cursor = conn.cursor()
    
    menu_items = [
        # 1. ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô (10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
        ("‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏ó‡∏≠‡∏î", 30.0, 1, True),
        ("‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏ô‡∏¢‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•", 30.0, 1, True),
        ("‡∏ä‡∏µ‡∏™‡πÄ‡∏Ñ‡πâ‡∏Å", 55.0, 1, True),
        ("‡∏ö‡∏¥‡∏á‡∏ã‡∏π‡∏ú‡∏•‡πÑ‡∏°‡πâ", 65.0, 1, True),
        ("‡∏õ‡∏±‡∏á‡πÄ‡∏¢‡πá‡∏ô‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï", 45.0, 1, True),
        ("‡πÄ‡∏Ñ‡∏£‡∏õ‡πÄ‡∏¢‡πá‡∏ô", 50.0, 1, True),
        ("‡πÄ‡∏â‡∏≤‡∏Å‡πä‡∏ß‡∏¢‡∏ô‡∏°‡∏™‡∏î", 35.0, 1, True),
        ("‡πÅ‡∏û‡∏ô‡πÄ‡∏Ñ‡πâ‡∏Å‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏´‡∏≠‡∏°", 50.0, 1, True),
        ("‡πÇ‡∏£‡∏ï‡∏µ‡πÉ‡∏™‡πà‡∏Å‡∏•‡πâ‡∏ß‡∏¢", 40.0, 1, True),
        ("‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°‡∏Å‡∏∞‡∏ó‡∏¥‡∏™‡∏î", 40.0, 1, True),

        # 2. ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏¢‡∏≥/‡∏™‡∏•‡∏±‡∏î (10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
        ("‡∏ã‡∏µ‡∏ã‡∏≤‡∏£‡πå‡∏™‡∏•‡∏±‡∏î", 75.0, 2, True),
        ("‡∏¢‡∏≥‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ô", 65.0, 2, True),
        ("‡∏¢‡∏≥‡∏°‡∏≤‡∏°‡πà‡∏≤", 65.0, 2, True),
        ("‡∏¢‡∏≥‡∏£‡∏ß‡∏°‡∏ó‡∏∞‡πÄ‡∏•", 85.0, 2, True),
        ("‡∏¢‡∏≥‡∏ß‡∏∏‡πâ‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏°‡∏π‡∏™‡∏±‡∏ö", 65.0, 2, True),
        ("‡∏¢‡∏≥‡πÑ‡∏Ç‡πà‡∏î‡∏≤‡∏ß", 60.0, 2, True),
        ("‡∏¢‡∏≥‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô", 90.0, 2, True),
        ("‡∏¢‡∏≥‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å", 60.0, 2, True),
        ("‡∏¢‡∏≥‡∏´‡∏°‡∏π‡∏¢‡∏≠", 60.0, 2, True),
        ("‡∏¢‡∏≥‡πÄ‡∏´‡πá‡∏î‡∏£‡∏ß‡∏°", 65.0, 2, True),

        # 3. ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡∏´‡∏°‡∏π‡∏™‡∏±‡∏ö‡πÑ‡∏Ç‡πà‡∏î‡∏≤‡∏ß", 65.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ", 60.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ñ‡∏•‡∏∏‡∏Å‡∏Å‡∏∞‡∏õ‡∏¥", 65.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ñ‡∏±‡πà‡∏ß‡∏Å‡∏•‡∏¥‡πâ‡∏á‡∏´‡∏°‡∏π", 70.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏•‡∏á‡πÄ‡∏£‡∏∑‡∏≠", 70.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏´‡∏°‡∏π", 60.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏£‡∏≤‡∏î‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡πÑ‡∏Å‡πà", 70.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏Å‡πà‡πÄ‡∏ó‡∏≠‡∏£‡∏¥‡∏¢‡∏≤‡∏Å‡∏¥", 75.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏°", 60.0, 3, True),
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡πÑ‡∏Ç‡πà‡πÄ‡∏à‡∏µ‡∏¢‡∏ß‡∏´‡∏°‡∏π‡∏™‡∏±‡∏ö", 55.0, 3, True),

        # 4. ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≤‡∏ô‡πÄ‡∏•‡πà‡∏ô (10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
        ("‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡∏ä‡∏µ‡∏™", 50.0, 4, True),
        ("‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡πá‡∏ï‡πÑ‡∏Å‡πà", 50.0, 4, True),
        ("‡∏õ‡∏µ‡∏Å‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤", 60.0, 4, True),
        ("‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏•‡∏ß‡∏Å‡∏à‡∏¥‡πâ‡∏°", 45.0, 4, True),
        ("‡∏´‡∏°‡∏π‡∏ó‡∏≠‡∏î‡∏à‡∏¥‡πâ‡∏°‡πÅ‡∏à‡πà‡∏ß", 60.0, 4, True),
        ("‡πÄ‡∏Å‡∏µ‡πä‡∏¢‡∏ß‡∏ã‡πà‡∏≤‡∏ó‡∏≠‡∏î", 50.0, 4, True),
        ("‡πÄ‡∏ü‡∏£‡∏ô‡∏ä‡πå‡∏ü‡∏£‡∏≤‡∏¢‡∏™‡πå", 45.0, 4, True),
        ("‡πÅ‡∏´‡∏ô‡∏°‡∏Ñ‡∏•‡∏∏‡∏Å", 55.0, 4, True),
        ("‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î‡πÄ‡∏Å‡∏•‡∏∑‡∏≠", 55.0, 4, True),
        ("‡πÑ‡∏Å‡πà‡∏õ‡πä‡∏≠‡∏õ", 55.0, 4, True),

        # 5. ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏° (10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
        ("‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô", 40.0, 5, True),
        ("‡∏ä‡∏≤‡∏°‡∏∞‡∏ô‡∏≤‡∏ß", 35.0, 5, True),
        ("‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏¢‡πá‡∏ô", 35.0, 5, True),
        ("‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏¢‡πá‡∏ô", 35.0, 5, True),
        ("‡∏ô‡∏°‡∏ä‡∏°‡∏û‡∏π", 35.0, 5, True),
        ("‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á‡∏°‡∏∞‡∏ô‡∏≤‡∏ß‡πÇ‡∏ã‡∏î‡∏≤", 45.0, 5, True),
        ("‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏ç‡∏ä‡∏±‡∏ô / ‡πÄ‡∏Å‡πä‡∏Å‡∏Æ‡∏ß‡∏¢ / ‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö", 30.0, 5, True),
        ("‡∏°‡πá‡∏≠‡∏Å‡πÄ‡∏ó‡∏•‡∏•‡∏¥‡πâ‡∏ô‡∏à‡∏µ‡πà‡πÇ‡∏ã‡∏î‡∏≤", 50.0, 5, True),
        ("‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà", 40.0, 5, True),
        ("‡πÇ‡∏Å‡πÇ‡∏Å‡πâ‡πÄ‡∏¢‡πá‡∏ô", 40.0, 5, True)
    ]
    
    for name, price, category_id, is_available in menu_items:
        cursor.execute(
            "INSERT INTO menu_items (name, price, category_id, is_available) VALUES (?, ?, ?, ?)",
            (name, price, category_id, is_available)
        )
    
    print(f"‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà {len(menu_items)} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß")
    conn.commit()
    conn.close()

def main():
    """‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å"""
    print("\n" + "="*60)
    print("üçΩÔ∏è FOOD POS SYSTEM - MENU UPDATE")
    print("   ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà")
    print("="*60)
    
    try:
        print("\nüóëÔ∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏î‡∏¥‡∏°...")
        clear_existing_menu()
        
        print("\nüìÇ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà...")
        add_categories()
        
        print("\nüçΩÔ∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà...")
        add_menu_items()
        
        print("\n" + "="*60)
        print("‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!")
        print("üìä ‡∏™‡∏£‡∏∏‡∏õ:")
        print("   - ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: 5 ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà")
        print("   - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£: 50 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£")
        print("="*60)
        
    except Exception as e:
        print(f"\n‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {e}")
        return False
    
    return True

if __name__ == "__main__":
    main()